{"version":3,"sources":["webpack:///./src/containers/SubscribeModal.jsx?4d5b"],"names":["SubscribeModal","props","type","state","isTip","status","fetchStatus","FETCHING","DONE","text","msg","hasSub","nextProps","setState","_status","formData","nickname","refs","subNickname","value","email","subEmail","test","handleTip","focus","length","addSubscribe","e","stopPropagation","which","handleSub","isOpen","closeSubscribeModal","clickPanel","handleKeyUp","bind","mapStateToProps","branch_state","site","subscribeModal","mapDispatchToProps","dispatch","openSubscribeModal"],"mappings":"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","file":"0.e6d73c8bf4164f3cea44.hot-update.js","sourcesContent":["import React, { Component } from 'react';\r\nimport ReactCSSTransitionGroup from 'react-addons-css-transition-group';\r\nimport { connect } from \"react-redux\";\r\nimport { Status } from '../constants';\r\nimport site from '../actions/site';\r\n\r\nclass SubscribeModal extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    let type = ''\r\n    \r\n    this.state = {\r\n      isTip: {\r\n        status: !!props.fetchStatus.status && props.fetchStatus !== Status.FETCHING,\r\n        type: props.fetchStatus.status === Status.DONE ? 'success' : 'error', // 'error' or 'success'\r\n        text: props.fetchStatus.msg,\r\n      },\r\n      hasSub: props.fetchStatus.status === Status.DONE,\r\n    }\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    this.setState = {\r\n      isTip: {\r\n        status: !!nextProps.fetchStatus.status && nextProps.fetchStatus !== Status.FETCHING,\r\n        type: nextProps.fetchStatus.status === Status.DONE ? 'success' : 'error', // 'error' or 'success'\r\n        text: nextProps.fetchStatus.msg,\r\n      },\r\n      hasSub: nextProps.fetchStatus.status === Status.DONE,\r\n    }\r\n  }\r\n\r\n  handleSub() {\r\n\r\n    const _status = this.props.fetchStatus.status;\r\n\r\n    // 正在请求中 或 已经订阅完毕，则不执行订阅\r\n    if ( _status === Status.FETCHING || _status === Status.DONE ) {\r\n      return false;\r\n    }\r\n\r\n    let formData = {\r\n      nickname: this.refs.subNickname.value,\r\n      email: this.refs.subEmail.value,\r\n    };\r\n\r\n    /* 表单验证 */\r\n  \tif ( !/\\S/.test(formData.nickname) ) {\r\n\r\n  \t  this.handleTip('error', '昵称不能为空');\r\n  \t  this.refs.subNickname.focus();\r\n  \t  return false;\r\n\r\n  \t} else if ( !/\\S/.test(formData.email) ) {\r\n\r\n        this.handleTip('error', '邮箱不能为空');\r\n        this.refs.subEmail.focus();\r\n        return false;\r\n\r\n  \t} else if ( formData.nickname.length > 20 ) {\r\n\r\n  \t  this.handleTip('error', '昵称过长');\r\n  \t  this.refs.subNickname.focus();\r\n  \t  return false;\r\n\r\n  \t} else if ( !/^\\w+@\\w+\\.\\w+(\\.\\w+)?$/.test(formData.email) ) {\r\n\r\n  \t  this.handleTip('error', '电子邮箱格式错误');\r\n  \t  this.refs.subEmail.focus();\r\n  \t  return false;\r\n\r\n  \t} else if ( formData.email.length > 50 ) {\r\n\r\n  \t  this.handleTip('error', '邮箱过长');\r\n  \t  this.refs.subEmail.focus();\r\n  \t  return false;\r\n\r\n  \t}\r\n\r\n  \tthis.props.addSubscribe(formData);\r\n\r\n  }\r\n\r\n  handleTip(type, text) {\r\n\r\n    this.setState({\r\n      isTip: {\r\n        status: true,\r\n        type: type,\r\n        text: text,\r\n      },\r\n      hasSub: type === 'success',\r\n    });\r\n  }\r\n\r\n  clearTip() {\r\n    this.setState({\r\n      isTip: {\r\n        status: false,\r\n        type: 'error',\r\n        text: '',\r\n      },\r\n      hasSub: false,\r\n    });\r\n  }\r\n\r\n  clickPanel(e) {\r\n  \te.stopPropagation();\r\n  }\r\n\r\n  handleKeyUp(e) {\r\n  \t// 回车\r\n  \tif( e.which == 13 ) {\r\n  \t\tthis.handleSub(this);\r\n  \t}\r\n  }\r\n\r\n  render() {\r\n\r\n  \treturn (\r\n      <ReactCSSTransitionGroup\r\n          transitionName=\"dropdown\" \r\n          transitionAppear={true} \r\n          transitionAppearTimeout={800}\r\n          transitionEnterTimeout={800}\r\n          transitionLeaveTimeout={800}\r\n        >\r\n        {\r\n          this.props.isOpen ?\r\n      \t  <div\r\n      \t    className=\"modal modal-sub\"\r\n      \t    onClick={this.props.closeSubscribeModal}\r\n      \t  >\r\n            <div className=\"mask\"></div>\r\n            <div\r\n              className=\"panel\"\r\n              onClick={this.clickPanel}\r\n            >\r\n              <h2>欢迎订阅</h2>\r\n              <div className=\"m-middle\">\r\n                <input\r\n                  type=\"text\" \r\n                  className=\"text\" \r\n                  placeholder=\"昵称\" \r\n                  name=\"nickname\"\r\n                  ref=\"subNickname\"\r\n                  onKeyUp={this.handleKeyUp}\r\n                />\r\n                <input \r\n                  type=\"email\" \r\n                  className=\"text\" \r\n                  placeholder=\"常用邮箱\" \r\n                  name=\"email\"\r\n                  ref=\"subEmail\"\r\n                  onKeyUp={this.handleKeyUp}\r\n                />\r\n                {\r\n                  this.state.hasSub ? \r\n                  <span\r\n    \t            className=\"btn success\"\r\n    \t          >✔ 已订阅</span>\r\n    \t          :\r\n    \t          <button\r\n                    className=\"btn\"\r\n                    onClick={this.handleSub.bind(this)}\r\n                  >订&nbsp;&nbsp;阅</button>\r\n                }\r\n              </div>\r\n              <div className=\"m-bottom\">\r\n                {\r\n                  this.state.isTip.status ? \r\n                  <p className=\"error-tip\">\r\n                    <span className={`icon ${this.state.isTip.type == 'error' ? 'icon-error' : 'icon-ok'}`}></span>\r\n                    <span className={`text ${this.state.isTip.type == 'error' ? '' : 'success'}`}>{this.state.isTip.text}</span>\r\n                  </p>\r\n                  :\r\n                  <div>\r\n                    <p>当有新博文发表时，将会以邮件形式通知您。</p>\r\n                    <p>所填信息不会被公开。</p>\r\n                  </div>\r\n                }\r\n              </div>\r\n            </div>\r\n          </div>\r\n          : ''\r\n        }\r\n      </ReactCSSTransitionGroup>\r\n  \t);\r\n\r\n  }\r\n\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  const branch_state = state.site.subscribeModal;\r\n  return branch_state;\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  openSubscribeModal: () => dispatch(site.openSubscribeModal),\r\n  closeSubscribeModal: () => dispatch(site.closeSubscribeModal),\r\n  addSubscribe: (formData) => dispatch(site.addSubscribe(formData)),\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SubscribeModal);\n\n\n// WEBPACK FOOTER //\n// ./src/containers/SubscribeModal.jsx"],"sourceRoot":""}